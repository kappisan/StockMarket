<!doctype html>
<html lang="en" class="no-js">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">

  	<link href='./style/style.css' rel='stylesheet' type='text/css'>

    <link href='./libs/juno.css' rel='stylesheet' type='text/css'>


    <link rel='shortcut icon' href='./img/logo5.png'>

    <!-- facebook meta data -->
    <meta property="og:title" content="kappisan" />
    <meta property="og:type" content="website" />
    <meta property="og:url" content="http://www.kappisan.com" />
    <meta property="og:image" content="http://www.kappisan.com/img/logo_rectangle.png" />
    
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.0/jquery.min.js"></script> 
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.4.8/angular.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.17.1/moment.min.js"></script>

    <script src="./libs/d3.v3.min.js"></script>
    
    <title>Stock Simulator</title>

    <style>

    .axis--x path {
      display: none;
    }
/*
    .axis {
        stroke: #fff;
        fill: #fff;
    }
*/
    .line {
      fill: none;
      stroke: steelblue;
      stroke-width: 1.5px;
    }

    .page-heading {
      font-size: 32pt;
    }








    </style>

</head>
<body ng-app="stockApp" ng-controller="mainCtrl">




<div class="wrapper">

    <input type="checkbox" id="navigation" />
    <label for="navigation">

        <!-- Hamburger -->

<div id="nav-icon3">
  <span></span>
  <span></span>
  <span></span>
  <span></span>
</div>

    </label>
<br><br><br><br><br><br><br><br>
    <nav>
        <ul>
            <li><p>
                <a class="tabs" href="cam.html"> &nbsp; &nbsp;Add Memory</a>
            </li>
            <li><p>
                <a class="tabs" href="timeline.html"> &nbsp; &nbsp;Memory Bank</a>
            </li>
            <li><p>
                <a class="tabs" href="./gmaps/index.html"> &nbsp; &nbsp;Memory Map</a>
            </li>
            <li><p>
                <a class="tabs" href="profile.html"> &nbsp; &nbsp;Profile</a>

            </li>

             <li><p>
                <a class="tabs" href="orb.html"> &nbsp; &nbsp;The Orb Relm</a>
            </li>
            <li><p>
                <a class="tabs" href="index.html"> &nbsp; &nbsp;Logout</a>
            </li>
        </ul>
    </nav>

        <section>
            <article>
                
</div>
    










<center>
<h1 class="typewriter page-heading">Stock Simulator</h1>
<hr>
</center>

<div>
    {{ user.username }}
    Â£{{ user.balance }}
</div>

<div class="line-svg"></div>

<table>
    <tr>
        <th>Date</th>
        <th>Price</th>
    </tr>
    <tr ng-repeat="valuation in company.kappisan">
        <td>{{ valuation.date }}</td>
        <td>{{ valuation.close }}</td>
    </tr>

</table>

<script>


$(document).ready(function(){
  $('#nav-icon1,#nav-icon2,#nav-icon3,#nav-icon4').click(function(){
    $(this).toggleClass('open');
  });
});



</script>



<script>

var app = angular.module('stockApp', []);

app.controller('mainCtrl', function($scope) {

    $scope.user = {
      username: "Kasper Wilkosz",
      balance: 59342,
      holdings: []
    }

    $scope.info = {
      name: "kappisan",
      shares: 2000000,
      volumeAverage: 3000,
      pe: 50.8,
      divYield: 1.2
    }

    $scope.company = {};

    $scope.company.kappisan = generateData();

    console.log("angular loaded", $scope.company);

    drawLineChart($scope.company.kappisan);

    function drawLineChart(data) {

      // Set the dimensions of the canvas / graph
      var margin = {top: 30, right: 20, bottom: 30, left: 50},
          width = 600 - margin.left - margin.right,
          height = 270 - margin.top - margin.bottom;

      // Parse the date / time
      var parseDate = d3.time.format("%d-%b-%y").parse;

      // Set the ranges
      var x = d3.time.scale().range([0, width]);
      var y = d3.scale.linear().range([height, 0]);

      // Define the axes
      var xAxis = d3.svg.axis().scale(x)
          .orient("bottom").ticks(5);

      var yAxis = d3.svg.axis().scale(y)
          .orient("left").ticks(5);

      // Define the line
      var valueline = d3.svg.line()
          .x(function(d) { return x(d.date); })
          .y(function(d) { return y(d.close); });
          
      // Adds the svg canvas
      var svg = d3.select(".line-svg")
          .append("svg")
              .attr("width", width + margin.left + margin.right)
              .attr("height", height + margin.top + margin.bottom)
          .append("g")
              .attr("transform", 
                    "translate(" + margin.left + "," + margin.top + ")");

      data.forEach(function(d) {
          d.date = parseDate(d.date);
      });

      // Scale the range of the data
      x.domain(d3.extent(data, function(d) { return d.date; }));
      y.domain(d3.extent(data, function(d) { return d.close; }));

      // Add the valueline path.
      svg.append("path")
          .attr("class", "line")
          .attr("d", valueline(data));

      // Add the X Axis
      svg.append("g")
          .attr("class", "x axis")
          .attr("transform", "translate(0," + height + ")")
          .call(xAxis);

      // Add the Y Axis
      svg.append("g")
          .attr("class", "y axis")
          .call(yAxis);
    }

    function generateData() {
        var data = [];

        var price = (Math.random() * 10) + 4;
        var multiplier = Math.random() - 0.5;
        var startDate = moment("01-Jan-14", "DD-MMM-YY");

        for(var i = 0; i < 100; i++) {

            if(i % 4 == 0) { multiplier = Math.random() - 0.5; }

            price += (Math.random() * multiplier);
            var date = startDate.add(1, "days")

            data.push({date: date.format("DD-MMM-YY"), close: price});        
        }

        return data;
    }

});

</script>

</body>
</html>